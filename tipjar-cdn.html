<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tip / Donate</title>
  <meta name="description" content="A unified tipjar / donation page with multiple payment options." />
  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            base: {
              bg: '#0f1115',
              soft: '#151923',
              card: '#0f1115',
              text: '#e6e8ee',
              muted: '#9aa3b2',
              ring: '#2b3344',
              accent: '#6ea8fe'
            }
          },
          boxShadow: {
            soft: '0 8px 28px rgba(0,0,0,.25), 0 2px 6px rgba(0,0,0,.15)'
          },
          borderRadius: { '2xl': '1rem' }
        }
      },
      darkMode: 'media'
    }
  </script>
  <!-- Alpine.js (light reactivity) -->
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <!-- QRCode.js (CDN) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    :root { color-scheme: dark light; }
    @media (prefers-color-scheme: light){
      html { background:#f7f7fb; }
    }
    .glass { backdrop-filter: blur(12px); background: rgba(255,255,255,0.04); }
  </style>
</head>
<body class="min-h-screen bg-[color:var(--bg,theme(colors.base.bg))] text-[color:var(--text,theme(colors.base.text))]">

<div class="max-w-6xl mx-auto px-4 py-8" x-data="tipjarApp()" x-init="init()">
  <!-- Header -->
  <header class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
    <div class="flex items-center gap-3">
      <div class="w-10 h-10 rounded-2xl grid place-items-center bg-[color:var(--soft,theme(colors.base.soft))] border border-[color:var(--ring,theme(colors.base.ring))]">
        <svg viewBox="0 0 24 24" fill="none" class="w-6 h-6"><rect width="24" height="24" rx="6" fill="currentColor" opacity="0.1"/><path d="M5 15c2.2 2.2 5.8 2.2 8 0s2.2-5.8 0-8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><path d="M7 9l3 3 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </div>
      <div>
        <h1 class="text-2xl md:text-3xl font-bold" x-text="cfg.title"></h1>
        <p class="text-sm text-[color:theme(colors.base.muted)]" x-text="cfg.subtitle"></p>
      </div>
    </div>
    <div class="flex gap-2">
      <button @click="share()" class="px-4 py-2 rounded-xl shadow-soft border border-[color:theme(colors.base.ring)] bg-[color:theme(colors.base.soft)] hover:-translate-y-0.5 transition">Share</button>
      <button @click="copyAll()" class="px-4 py-2 rounded-xl shadow-soft border border-[color:theme(colors.base.ring)] bg-[color:theme(colors.base.accent)] text-white hover:-translate-y-0.5 transition">Copy all</button>
    </div>
  </header>

  <!-- Cards grid -->
  <section class="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
    <!-- Rendered by x-for -->
    <template x-for="card in cards" :key="card.key">
      <article class="flex items-start gap-3 p-4 rounded-2xl shadow-soft border border-[color:theme(colors.base.ring)] bg-[color:theme(colors.base.card)]">
        <img :src="iconUrl(card.key)" @error="handleIconError($event, card.title)" class="w-12 h-12 rounded-xl p-2 bg-[color:theme(colors.base.soft)] border border-[color:theme(colors.base.ring)] object-contain" alt=""/>
        <div class="flex-1 min-w-0">
          <h3 class="font-semibold" x-text="card.title"></h3>
          <p class="text-sm text-[color:theme(colors.base.muted)]" x-text="card.hint"></p>
          <div class="mt-3 flex flex-wrap items-center gap-2">
            <div class="px-2 py-1 rounded-xl border border-[color:theme(colors.base.ring)] bg-[color:theme(colors.base.soft)] text-xs font-mono truncate max-w-full" x-text="card.code || '—'"></div>
            <div class="ml-auto flex gap-2">
              <button @click="copy(card.code)" class="px-3 py-1.5 rounded-xl border border-[color:theme(colors.base.ring)] bg-[color:theme(colors.base.soft)] text-sm">Copy</button>
              <template x-if="card.openUrl">
                <a :href="card.openUrl" target="_blank" rel="noopener" class="px-3 py-1.5 rounded-xl border border-[color:theme(colors.base.ring)] bg-[color:theme(colors.base.soft)] text-sm">Open</a>
              </template>
              <template x-if="card.uri && !card.openUrl">
                <a :href="card.uri" class="px-3 py-1.5 rounded-xl border border-[color:theme(colors.base.ring)] bg-[color:theme(colors.base.soft)] text-sm">URI</a>
              </template>
            </div>
          </div>
        </div>
        <div class="ml-auto grid place-items-center">
          <div :id="'qr-'+$index" class="w-32 h-32 rounded-xl border border-[color:theme(colors.base.ring)] bg-[color:theme(colors.base.soft)]"></div>
        </div>
      </article>
    </template>
              <template x-if="card.uri">
                <a :href="card.uri" class="px-3 py-1.5 rounded-xl border border-[color:theme(colors.base.ring)] bg-[color:theme(colors.base.soft)] text-sm">URI</a>
              </template>
              <template x-if="card.qrPayload">
                <button @click="openQR(card)" class="px-3 py-1.5 rounded-xl border border-[color:theme(colors.base.ring)] bg-[color:theme(colors.base.soft)] text-sm">QR</button>
              </template>
            </div>
          </div>
        </div>
      </article>
    </template>
  </section>

  <!-- Footer -->
  <footer class="mt-8 text-xs text-[color:theme(colors.base.muted)]">
    <span class="inline-block px-2 py-0.5 rounded-full border border-[color:theme(colors.base.ring)] mr-2">Privacy</span>
    This page is static; it makes no network calls except to CDNs for the UI libraries. Nothing is stored.
    <div class="mt-2">Tipjar boilerplate © <span x-text="year"></span> • MIT‑licensed snippet. Copy, remix, re-use.</div>
  </footer>

  
</div>

<script>
function tipjarApp(){
  return {
    year: new Date().getFullYear(),
    cfg: {
      title: 'Tip / Donate',
      subtitle: 'Thanks for supporting my work — pick whatever method is easiest.',

      // Traditional & platforms
      paypalMe: '',          // e.g. "yourname" for paypal.me/yourname
      paypalEmail: '',       // fallback email
      venmo: '',             // e.g. "@yourhandle"
      cashapp: '',           // e.g. "$yourtag"
      zelle: '',             // email or phone
      stripeLink: '',        // Stripe Payment Link URL
      patreon: '',           // username
      kofi: '',              // username
      buymeacoffee: '',      // username
      githubSponsors: '',    // handle
      donorbox: '',          // campaign slug or full URL

      // Bank-ish
      achName: '',
      achRouting: '',
      achAccount: '',

      // Crypto
      btc: '',               // on-chain address
      lightning: '',         // LNURL or Lightning Address (name@domain)
      eth: '',               // 0x...
      sol: '',               // Solana address
      usdcSol: '',           // optional SPL address
      xmr: '',

      // Other custom
      other: [
        // { label: 'Tezos', code: 'tz1...', openUrl: 'https://tzkt.io/tz1...' }
      ],
    },

    cards: [],
    qr: { title: '', payload: '', href: '' },

    init(){
      this.rebuild();
    },

    rebuild(){
      const C = this.cfg; const out = [];
      const push = (o)=> out.push(o);
      const clean = (s)=> (s||'').trim();
      const nonempty = (s)=> !!clean(s);

      // PayPal
      if (nonempty(C.paypalMe) || nonempty(C.paypalEmail)){
        const url = nonempty(C.paypalMe) ? `https://paypal.me/${clean(C.paypalMe)}` : `mailto:${clean(C.paypalEmail)}`;
        push({key:'paypal', title:'PayPal', hint:'PayPal.Me or email', code: nonempty(C.paypalMe) ? `paypal.me/${clean(C.paypalMe)}` : clean(C.paypalEmail), openUrl:url, uri: url, qrPayload:url});
      }
      // Venmo
      if (nonempty(C.venmo)){
        const handle = C.venmo.startsWith('@')? C.venmo : '@'+C.venmo;
        const url = `https://venmo.com/${handle.replace('@','')}`;
        push({key:'venmo', title:'Venmo', hint:'Handle', code: handle, openUrl:url, uri:url, qrPayload:url});
      }
      // Cash App
      if (nonempty(C.cashapp)){
        const tag = C.cashapp.startsWith('$')? C.cashapp : '$'+C.cashapp;
        const url = `https://cash.app/${tag.replace('$','')}`;
        push({key:'cashapp', title:'Cash App', hint:'Cashtag', code: tag, openUrl:url, uri:url, qrPayload:url});
      }
      // Zelle (display only)
      if (nonempty(C.zelle)){
        push({key:'zelle', title:'Zelle', hint:'Email or phone', code: clean(C.zelle)});
      }
      // Stripe Link
      if (nonempty(C.stripeLink)){
        const url = clean(C.stripeLink);
        push({key:'stripe', title:'Card / Apple Pay (Stripe Link)', hint:'Hosted checkout', code: new URL(url).host, openUrl:url, uri:url, qrPayload:url});
      }
      // Patreon
      if (nonempty(C.patreon)){
        const u = clean(C.patreon);
        const url = `https://patreon.com/${u}`;
        push({key:'patreon', title:'Patreon', hint:'Monthly support', code:`patreon.com/${u}`, openUrl:url, uri:url, qrPayload:url});
      }
      // Ko-fi
      if (nonempty(C.kofi)){
        const u = clean(C.kofi); const url = `https://ko-fi.com/${u}`;
        push({key:'kofi', title:'Ko‑fi', hint:'One‑off or monthly', code:`ko-fi.com/${u}`, openUrl:url, uri:url, qrPayload:url});
      }
      // Buy Me a Coffee
      if (nonempty(C.buymeacoffee)){
        const u = clean(C.buymeacoffee); const url = `https://www.buymeacoffee.com/${u}`;
        push({key:'bmac', title:'Buy Me a Coffee', hint:'One‑off or monthly', code:`buymeacoffee.com/${u}`, openUrl:url, uri:url, qrPayload:url});
      }
      // GitHub Sponsors
      if (nonempty(C.githubSponsors)){
        const u = clean(C.githubSponsors); const url = `https://github.com/sponsors/${u}`;
        push({key:'gh', title:'GitHub Sponsors', hint:'Support open source', code:`github.com/sponsors/${u}`, openUrl:url, uri:url, qrPayload:url});
      }
      // Donorbox
      if (nonempty(C.donorbox)){
        const url = C.donorbox.startsWith('http')? clean(C.donorbox): `https://donorbox.org/${clean(C.donorbox)}`;
        push({key:'donorbox', title:'Donorbox', hint:'Nonprofit‑friendly checkout', code:url.replace(/^https?:\/\//,''), openUrl:url, uri:url, qrPayload:url});
      }

      // Bank (display only)
      if (nonempty(C.achRouting) && nonempty(C.achAccount)){
        const name = nonempty(C.achName) ? `${C.achName} · ` : '';
        push({key:'ach', title:'Bank Transfer (ACH)', hint:'Routing · Account', code:`${name}${C.achRouting} · ${C.achAccount}`});
      }

      // Crypto
      if (nonempty(C.btc)){
        const addr = clean(C.btc); const uri = `bitcoin:${addr}`;
        push({key:'btc', title:'Bitcoin', hint:'On‑chain address', code:addr, uri, qrPayload:uri});
      }
      if (nonempty(C.lightning)){
        const ln = clean(C.lightning);
        const uri = ln.startsWith('lnurl') || ln.startsWith('lightning:') ? ln : `lightning:${ln}`;
        push({key:'lightning', title:'Lightning', hint:'LNURL / Lightning Address', code:ln, uri, qrPayload:uri});
      }
      if (nonempty(C.eth)){
        const addr = clean(C.eth); const uri = `ethereum:${addr}`;
        push({key:'eth', title:'Ethereum', hint:'EVM address', code:addr, uri, qrPayload:uri});
      }
      if (nonempty(C.sol)){
        const addr = clean(C.sol); const uri = `solana:${addr}`;
        push({key:'sol', title:'Solana', hint:'SOL / SPL token address', code:addr, uri, qrPayload:uri});
      }
      if (nonempty(C.usdcSol)){
        const addr = clean(C.usdcSol); const uri = `solana:${addr}`;
        push({key:'usdc', title:'USDC (Solana)', hint:'SPL address', code:addr, uri, qrPayload:uri});
      }
      if (nonempty(C.xmr)){
        const addr = clean(C.xmr); push({key:'xmr', title:'Monero', hint:'Address (opaque)', code:addr, qrPayload:addr});
      }

      // Custom
      (C.other||[]).forEach((o,i)=>{ if(!o) return; push({key:'custom', title:o.label||`Method ${i+1}`, hint:o.hint||'Info', code:o.code||'', openUrl:o.openUrl||'', uri:o.uri||o.openUrl||'', qrPayload:o.qr || o.uri || o.openUrl || o.code}); });

      this.cards = out;
      this.$nextTick(()=> this.renderQRCodes());
    },

    copy(text){
      if(!text) return;
      navigator.clipboard.writeText(String(text)).then(()=> this.toast('Copied')).catch(()=> this.toast('Copy failed', true));
    },
    copyAll(){
      const lines = this.cards.filter(c=>c.code).map(c=> `${c.title}: ${c.code}`);
      this.copy(lines.join('\n'));
    },
    share(){
      const text = this.cfg.subtitle || 'Support my work';
      if (navigator.share){ navigator.share({title: document.title, text, url: location.href}).catch(()=>{}); }
      else { this.copy(location.href); }
    },

    renderQRCodes(){
      const size = 176;
      this.cards.forEach((c,i)=>{
        const el = document.getElementById('qr-'+i);
        if (!el) return;
        el.innerHTML = '';
        if (!c.qrPayload) { el.classList.add('opacity-40'); el.title='No QR for this method'; return; }
        try { new QRCode(el, { text: c.qrPayload, width: size, height: size, correctLevel: QRCode.CorrectLevel.M }); }
        catch { el.textContent = 'QR failed'; }
      });
    },

    toast(msg, isErr=false){
      const t = document.createElement('div');
      t.textContent = msg;
      t.className = `fixed bottom-4 left-1/2 -translate-x-1/2 px-3 py-2 rounded-xl text-sm ${isErr? 'bg-red-400 text-black' : 'bg-emerald-400 text-black'} shadow-soft`;
      document.body.appendChild(t);
      setTimeout(()=> t.remove(), 1400);
    },

    iconMap: {
      paypal: 'paypal',
      venmo: 'venmo',
      cashapp: 'cashapp',
      zelle: 'zelle', // may not exist; will fallback
      stripe: 'stripe',
      patreon: 'patreon',
      kofi: 'kofi',
      bmac: 'buymeacoffee',
      gh: 'github',
      donorbox: 'donorbox',
      ach: 'bank', // fallback
      btc: 'bitcoin',
      lightning: 'lightning',
      eth: 'ethereum',
      sol: 'solana',
      usdc: 'usdcoin',
      xmr: 'monero',
      custom: 'generic'
    },
    iconUrl(key){
      const slug = this.iconMap[key] || 'generic';
      const known = ['paypal','venmo','cashapp','stripe','patreon','kofi','buymeacoffee','github','donorbox','bitcoin','lightning','ethereum','solana','usdcoin','monero'];
      if (known.includes(slug)){
        return `https://cdn.simpleicons.org/${slug}`;
      }
      if (slug === 'zelle') return 'https://cdn.simpleicons.org/contactlesspayment';
      if (slug === 'bank') return 'https://cdn.simpleicons.org/wise';
      return 'https://cdn.simpleicons.org/currencyexchange';
    },
    handleIconError(ev, label){
      const el = ev.target; // replace image with an initial badge
      const wrap = document.createElement('div');
      wrap.className = 'w-12 h-12 rounded-xl bg-[color:theme(colors.base.soft)] border border-[color:theme(colors.base.ring)] grid place-items-center text-xs font-semibold';
      wrap.textContent = (label||'?').slice(0,2).toUpperCase();
      el.replaceWith(wrap);
    }
  }
}
</script>
</body>
</html>
